---
title: "Environmental Policy Preference Across Demographics and Ideology"
author: "Chris Mesfin"
description: "GOV 50 Final Project: Data Analysis"
output:
  distill::distill_article:
    self_contained: false
---

```{r, echo = FALSE}
library(tidyverse)
library(sjlabelled)
library(haven)
library(ggridges)
library(broom)

options(
  knitr.kable.NA = '',
  width = 100)
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  fig.align = "center")
```

```{r, echo = FALSE}
ces <- left_join(
read_dta("cumulative_2006-2021.dta"),
read_dta("cumulative_ces_policy_preferences.dta")
) |>
sjlabelled::as_label()
```

```{r, echo = FALSE}
outcome_ces <- ces |>
  select("year", "case_id", "weight", "weight_cumulative", "state", "county_fips", "enviro_carbon") |>
  drop_na()
```
## Project Proposal 

How can different demographics, geography and socioeconomic status impact approval of climate policy or action on climate change? I hypothesize that the strongest correlation between an explanatory variable and the outcome variable(support for climate policy) will be seen with the separation across partly lines. Additionally there will be a weaker correlation when evaluating race as an explanatory variable. I will test this hypothesis through data collected from the Cumulative CES Policy Preferences which includes policy preferences from 2006 to 2021 and the Cumulative CCES Common Content data which contains many of the explanatory data I will analyze. Both of these data sources are broad surveys that sample random populations across the United States. Throughout my analysis i will use several different explanatory variables which will be in the form of different environmental policies that were surveyed in the CCES data. If I find that there is a greater support for environmental policies among democrats and other demographics that may lean overwhelmingly progressive then my hypothesis will be proven correct. This would be noted by a positive and significant coefficient when I run my regression. 

# Introduction 

Using survey data generated from counties across the United States this project seeks to determine the impact of various demographics, geographic locations, and socioeconomic statuses on various environmental policy preferences. 


# Data and Research Design 

To investigate these relationships I relied on data from 2 different sources.

1. **Cumulative CES Policy Preferences** which compiles policy preference question items from Cooperative Election Study (CES) polls over time. Specifically, this data set compiles the results from 557,456 responses across 54 policy preference question items, from 2006-2021. In this report I analyzed the responses in relation to only one of these policy preferences enviro_carbon. The question asked to respondents on this policy preference asked whether the respondent believe that the power should be **given** to the Environmental Protection Agency to regulate carbon dioxide emissions. 


2. **Cumulative CCES Common Content** which compiles the same policy preference data from the above data set, but adds several categorical variables that will be of use in this report. The main variables I will focus on in this report are race and gender demographics along with political ideologies. 

The research design is observational with correlational analysis that makes no assumptions about causal relationships. 


The Cumulative CES Policy Preferences data provides the outcome variable, **Support for EPA CO2 Regulation**. This preference were obtained through a survey where respondents could select support or oppose for the policy. With this in mind, this of the outcome variable can be demonstrated as a proportion of support to number of respondents. Below are graphics demonstrating first, the overall proportion of support to opposition of EPA carbon regulation within the entirety of the country, and second, the proportion of support across every county within the US.


```{r, echo = FALSE}
outcome_ces |>
  ggplot()+
  geom_bar(
    aes(
      x = enviro_carbon,
      y = ..count../sum(..count..)
    ), width = .25, fill = "grey20", col = "white"
  ) +
  labs(title = "Overall Distribution of EPA Carbon Regulation Support",
       x = "EPA Carbon Regulation Preference",
       y = "Proportion",
       caption = "Source: Cumulative CES Policy Preferences")
 

```
```{r, echo = FALSE}
ces |>
  mutate(carbon = if_else(enviro_carbon == "Support", 1, 0)) |>
  group_by(county_fips) |>
  summarize(average = mean(carbon, na.rm = TRUE)) |>
  ggplot(aes(x = average)) +
  geom_histogram(aes(y = ..density..), fill = "grey20", col = "white")+
  labs(title = "Distribution of County Level Proportions of Support",
       x = "Propotion of Support for EPA Carbon Regulation",
       y = "Density",
       caption = "Source: Cumulative CES Policy Preferences;\nCumulative CCES Common Content")
```

The range of proportion as seen in the second plot is anywhere from 0 to 1 meaning that there are some examples of counties where no respondents supported the policy, and some counties where all respondents supported the county.  

# Results 

Before performing the regression of Support for Carbon Regulation on the identified explanatory variables, the bivariate relationship can be visualized in a scatter plot. Each data point in these plots represents a unique county in the US with a proportion of CRPP and a proportion for the explanatory variable. The explanatory variable is on the x axis and CRPP is on the y axis. 


```{r Multivariate Analysis Female Proportion vs. CRPP, echo = FALSE}
ces |>
  mutate(carbon = if_else(enviro_carbon == "Support", 1, 0)) |>
  group_by(county_fips) |>
  summarize(
    average = mean(carbon, na.rm = TRUE),
    prop_female = mean(gender == "Female", na.rm = TRUE)) |>
  ggplot(aes(x = prop_female, y = average)) +
  geom_point(shape = 1) +
  geom_smooth(method = "lm")+
  xlim(0,1) + ylim(0,1)+
  labs(title = "Carbon Regulation Support by Proportion of Women",
       x = "Proportion of Women",
       y = "Proportion of Support",
       caption = "Source: Cumulative CES Policy Preferences;\nCumulative CCES Common Content")
```
```{r Bivariate Analysis of Minority Prop vs. CRPP, echo = FALSE}
ces |>
  mutate(carbon = if_else(enviro_carbon == "Support", 1, 0),
         Nonwhite = if_else(race == "White", 0, 1)) |>
  group_by(county_fips) |>
  summarize(
    average = mean(carbon, na.rm = TRUE),
    prop_nonwhite = (mean(Nonwhite, na.rm = TRUE))) |>
  ggplot(aes(x = prop_nonwhite, y = average)) +
  geom_point(shape = 1) +
  geom_smooth(method = "lm")+
  xlim(0,1) + ylim(0,1)+
  labs(title = "Carbon Regulation Support by Proportion of Minorities",
       x = "Proportion of Minorities",
       y = "Proportion of Support",
       caption = "Source: Cumulative CES Policy Preferences;\nCumulative CCES Common Content")
```
```{r Bivariate Analysis of Support vs. Ideology, echo = FALSE}
ces |>
  mutate(carbon = ifelse(enviro_carbon == "Support", 1, 0),
         liberal = ifelse(ideo5 == "Very Liberal" | ideo5 == "Liberal", 1, 0)) |>
  group_by(county_fips) |>
  summarize(
    average = mean(carbon, na.rm = TRUE),
    prop_Liberal = mean(liberal, na.rm = TRUE)) |>
  ggplot(aes(x = prop_Liberal, y = average)) +
  geom_point(shape = 1) +
  geom_smooth(method = "lm")+
  xlim(0,1) + ylim(0,1)+
  labs(title = "Carbon Regulation Support by Proportion of Liberals",
       x = "Proportion of Liberals",
       y = "Proportion of Support",
       caption = "Source: Cumulative CES Policy Preferences;\nCumulative CCES Common Content")
```


The line of best fit that has been drawn in each of these plots shows us that there is an positive relationship between higher proportions of women, minorities, and liberals, and support for EPA regulation on carbon. The following regression will provide more information on these positive relationships. 


```{r Bivariate Regression, echo = FALSE}
edited_ces <- ces |>
  mutate(carbon = if_else(enviro_carbon == "Support", 1, 0),
         Nonwhite = if_else(race == "White", 0, 1),
         liberal = if_else(ideo5 == "Liberal", 1, 0),
         unemployed = if_else(employ == "Unemployed", 1, 0))

reg_1 <- lm(data = edited_ces,
   carbon ~ Nonwhite)
reg_1
```
```{r multivariate regresssion, echo = FALSE}
reg_2 <- lm(data = edited_ces,
   carbon ~ Nonwhite + liberal + unemployed)
reg_2
```



## Conclusion 















